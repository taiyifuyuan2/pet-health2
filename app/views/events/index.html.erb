<!-- 予定一覧ヘッダー -->
<div class="events-header">
  <div class="events-header-content">
    <h1 class="events-title">
      <%= image_tag "icons/calendar.jpeg", alt: "予定", class: "icon-inline" %>
      予定一覧
    </h1>
    <p class="events-subtitle">ペットの健康管理スケジュール</p>
  </div>
  <div class="events-header-actions">
    <%= link_to "予定を追加", new_event_path, class: "btn btn-primary" %>
    <%= link_to "ダッシュボード", dashboard_path, class: "btn btn-secondary" %>
  </div>
</div>

<!-- 統計カード -->
<div class="stats-grid">
  <div class="stat-card">
    <div class="stat-icon">
      <%= image_tag "icons/calendar.jpeg", alt: "予定", class: "icon" %>
    </div>
    <div class="stat-content">
      <div class="stat-number"><%= @events.count %></div>
      <div class="stat-label">今月の予定</div>
    </div>
  </div>
  <div class="stat-card">
    <div class="stat-icon">
      <%= image_tag "icons/check.svg", alt: "完了", class: "icon" %>
    </div>
    <div class="stat-content">
      <div class="stat-number"><%= @events.completed.count %></div>
      <div class="stat-label">完了済み</div>
    </div>
  </div>
  <div class="stat-card">
    <div class="stat-icon">⏳</div>
    <div class="stat-content">
      <div class="stat-number"><%= @events.pending.count %></div>
      <div class="stat-label">未完了</div>
    </div>
  </div>
  <div class="stat-card">
    <div class="stat-icon">
      <%= image_tag "icons/dog.jpeg", alt: "ペット", class: "icon" %>
    </div>
    <div class="stat-content">
      <div class="stat-number"><%= @events.select { |event| event.subject_type == 'Pet' }.count %></div>
      <div class="stat-label">ペット関連</div>
    </div>
  </div>
</div>

<!-- 月間ナビゲーション -->
<div class="month-navigation">
  <div class="month-info">
    <h2 class="month-title"><%= @month.strftime('%Y年%m月') %></h2>
    <p class="month-subtitle"><%= @events.count %>件の予定</p>
  </div>
  <div class="month-actions">
    <%= link_to "前月", events_path(month: @month.prev_month.strftime('%Y-%m')), class: "btn btn-outline" %>
    <%= link_to "次月", events_path(month: @month.next_month.strftime('%Y-%m')), class: "btn btn-outline" %>
  </div>
</div>

<!-- 予定リスト -->
<% if @events.any? %>
  <div class="events-list">
    <% @events.each do |event| %>
      <div class="event-card event-<%= event.event_type || 'other' %>">
        <div class="event-card-content">
          <h3 class="event-card-title"><%= event.title %></h3>
          <div class="event-card-info">
            <div class="event-info-item">
              <span class="info-icon">
                <%= image_tag "icons/dog.jpeg", alt: "ペット", class: "icon-small" %>
              </span>
              <span class="info-text"><%= event.subject.name %></span>
            </div>
            <div class="event-info-item">
              <span class="info-icon">
                <%= image_tag "icons/calendar.jpeg", alt: "日付", class: "icon-small" %>
              </span>
              <span class="info-text"><%= event.scheduled_at&.strftime('%m月%d日') || '日付未設定' %></span>
            </div>
            <% if event.scheduled_at&.strftime('%H:%M') != '00:00' %>
              <div class="event-info-item">
                <span class="info-icon">
                  <%= image_tag "icons/clock.jpeg", alt: "時刻", class: "icon-small" %>
                </span>
                <span class="info-text"><%= event.scheduled_at&.strftime('%H:%M') %></span>
              </div>
            <% end %>
          </div>
          <% if event.description.present? %>
            <div class="event-card-note">
              <p><%= truncate(event.description, length: 80) %></p>
            </div>
          <% end %>
        </div>
        <div class="event-card-footer">
          <div class="event-footer-content">
            <div class="event-status">
              <% if event.pending? %>
                <span class="status-badge pending">未完了</span>
              <% else %>
                <span class="status-badge completed">完了済み</span>
              <% end %>
            </div>
            <div class="event-footer-actions">
              <%= link_to "詳細", event, class: "btn btn-sm btn-secondary" %>
              <% if event.pending? %>
                <%= link_to "完了", complete_event_path(event), data: { turbo_method: :patch }, class: "btn btn-sm btn-success" %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="empty-events">
    <div class="empty-events-content">
      <div class="empty-icon">
        <%= image_tag "icons/calendar.jpeg", alt: "カレンダー", class: "icon-large" %>
      </div>
      <h2>この月の予定はありません</h2>
      <p>新しい予定を追加して、ペットの健康管理を始めましょう</p>
      <%= link_to "予定を追加", new_event_path, class: "btn btn-primary btn-lg" %>
    </div>
  </div>
<% end %>
